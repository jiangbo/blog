# 1139-阳光岛-标题按钮功能

## 目标

实现标题场景的按钮的功能。

## 环境

- Time 2026-01-31
- Zig 0.15.1

## 参考

1. <https://www.bilibili.com/video/BV1jf9XYQEhW>

## 想法

四个按钮，功能不复杂。

## title.zig

实现了按钮功能。

```zig
const std = @import("std");
const zhu = @import("zhu");

const batch = zhu.batch;

const menu = @import("menu.zig");
const scene = @import("scene.zig");

const Background = struct {
    image: zhu.graphics.Image,
    offset: f32 = 0,

    fn update(self: *Background, delta: f32, speed: f32) void {
        self.offset -= speed * delta;
        if (self.offset > 0) self.offset -= self.image.area.size.x;
    }

    fn draw(self: *const Background, y: f32) void {
        // 填满 X 轴
        var x: f32 = self.offset;
        while (x < zhu.window.size.x) : (x += self.image.area.size.x) {
            zhu.batch.drawImage(self.image, .xy(@round(x), y), .{});
        }
    }
};

var far: Background = undefined;
var mid: Background = undefined;
var showHelp: bool = false;

pub fn init() void {
    far = .{ .image = zhu.getImage("textures/Layers/back.png") };
    mid = .{ .image = zhu.getImage("textures/Layers/middle.png") };

    zhu.audio.playMusic("assets/audio/platformer_level03_loop.ogg");
}

pub fn update(delta: f32) void {
    far.update(delta, 20);
    mid.update(delta, 60);

    if (showHelp) {
        if (zhu.window.isAnyRelease()) showHelp = false;
        return;
    }

    if (menu.update()) |event| {
        switch (event) {
            0 => scene.start(), // 开始游戏
            1 => scene.load(), // 加载存档
            2 => showHelp = true, // 显示帮助
            3 => zhu.window.exit(), // 退出游戏
            else => unreachable,
        }
    }
}

pub fn draw() void {
    far.draw(0);
    mid.draw(96);

    const titleImageId = zhu.imageId("textures/UI/title-screen.png");
    const center = zhu.window.size.scale(0.5);
    batch.drawImageId(titleImageId, center.addY(-50), .{
        .scale = .xy(2, 2),
        .anchor = .center,
    });

    menu.draw();
    // 底部信息栏
    const strPos: zhu.Vector2 = .xy(center.x, zhu.window.size.y - 26);
    zhu.text.drawTextCenter("SunnyLand Credits: XXX - 2025", strPos, .{
        .color = .rgba(0.8, 0.8, 0.8, 1),
    });
    if (!showHelp) return;

    // 绘制帮助界面
    const helpImageId = zhu.imageId("textures/UI/instructions.png");
    batch.drawImageId(helpImageId, center, .{
        .scale = .xy(2, 2),
        .anchor = .center,
    });
}
```

## 效果

![标题按钮功能][1]

[1]: images/阳光岛36.png

## 附录
