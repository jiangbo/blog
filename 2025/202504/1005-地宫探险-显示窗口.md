# 1005-地宫探险-显示窗口

## 目标

新建另一个游戏开发教程，然后初始化环境，打开窗口并显示一张图片。

## 环境

- Time 2025-10-22
- Zig 0.15.2

## 参考

1. <https://pragprog.com/titles/hwrust/hands-on-rust/>
2. 《Rust游戏开发实战》

## 想法

书籍使用的 Rust 语言写的，不清楚使用 Zig 是否可以实现，先试试，不行就放弃。
会复用之前开发英雄救美的引擎的代码，环境这些设置就不再重复了，最后会提交源代码。

## main.zig

```zig
const std = @import("std");
const builtin = @import("builtin");
const zhu = @import("zhu");

const window = zhu.window;
// const scene = @import("scene.zig");
const gfx = zhu.gfx;
const camera = zhu.camera;

pub extern "Imm32" fn ImmDisableIME(i32) std.os.windows.BOOL;

pub var texture: gfx.Texture = undefined;
pub fn init() void {
    // scene.init();
    camera.init(100);
    texture = gfx.loadTexture("assets/dungeonfont.png", .init(512, 512));
}

pub fn frame(delta: f32) void {
    _ = delta;
    // scene.update(delta);
    // scene.draw();
    camera.beginDraw();
    defer camera.endDraw();

    camera.draw(texture, .zero);
}

pub fn deinit() void {
    // scene.deinit();

}

pub fn main() void {
    var allocator: std.mem.Allocator = undefined;
    var debugAllocator: std.heap.DebugAllocator(.{}) = undefined;
    if (builtin.mode == .Debug) {
        debugAllocator = std.heap.DebugAllocator(.{}).init;
        allocator = debugAllocator.allocator();
    } else {
        allocator = std.heap.c_allocator;
    }

    defer if (builtin.mode == .Debug) {
        _ = debugAllocator.deinit();
    };

    if (builtin.os.tag == .windows) {
        _ = ImmDisableIME(-1);
    }

    window.run(allocator, .{
        .title = "地宫探险",
        .logicSize = .{ .x = 512, .y = 512 },
    });
}
```

## 效果

![显示窗口][1]

[1]: images/地宫探险01.png

## 附录
