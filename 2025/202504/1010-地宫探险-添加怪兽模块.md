# 1010-地宫探险-添加怪兽模块

## 目标

新增怪兽模块，目前只添加位置和纹理两个组件，先把它们渲染到地图上。

## 环境

- Time 2025-10-24
- Zig 0.15.2

## 参考

1. <https://pragprog.com/titles/hwrust/hands-on-rust/>
2. 《Rust游戏开发实战》

## 想法

新增怪兽模块还挺简单的，如果只是渲染的话，不清楚后面新增其它组件麻不麻烦。

## monster.zig

```zig
const std = @import("std");
const zhu = @import("zhu");

const ecs = zhu.ecs;

const map = @import("map.zig");

pub fn init() void {
    for (map.rooms[1..]) |room| {
        const enemy = ecs.w.createEntity();

        const center = map.center(room);
        ecs.w.add(enemy, map.worldPosition(center));

        const enemyTile = switch (zhu.randomIntMost(u8, 0, 3)) {
            0 => map.Tile.ettin,
            1 => map.Tile.ogre,
            2 => map.Tile.orc,
            else => map.Tile.goblin,
        };

        ecs.w.add(enemy, map.getTextureFromTile(enemyTile));
    }
}
```

## scene.zig

场景中新增了怪兽模块的初始化。

```zig
pub fn init() void {
    ecs.init(window.allocator);

    window.initFont(.{
        .font = @import("zon/font.zon"),
        .texture = gfx.loadTexture("assets/font.png", .init(960, 960)),
    });

    camera.frameStats(true);
    camera.init(5000);
    camera.scale = .init(scale, scale);

    map.init();
    player.init();
    monster.init();

    sceneCall("enter", .{});
}
```

## 效果

![添加怪兽][1]

[1]: images/地宫探险06.png

## 附录
