# 1114-阳光岛-实现钻石动画

## 目标

实现钻石的动画效果。

## 环境

- Time 2026-01-24
- Zig 0.15.1

## 参考

1. <https://www.bilibili.com/video/BV1jf9XYQEhW>

## 想法

新增了一个对象 object 模块，来处理物品，敌人这些。

## object.zig

实现钻石的动画效果。

```zig
const std = @import("std");
const zhu = @import("zhu");

const batch = zhu.batch;

const map = @import("map.zig");
const getImage = zhu.assets.getImage;

const gemFrames = zhu.graphics.loopFramesX(5, .xy(15, 13), 0.2);
var gemAnimation: zhu.graphics.FrameAnimation = undefined;

var items: []map.Object = undefined;

pub fn init(objects: []map.Object) void {
    items = objects;

    const gemImage = getImage(@intFromEnum(map.ObjectEnum.gem));
    gemAnimation = .init(gemImage, &gemFrames);
}

pub fn update(delta: f32) void {
    gemAnimation.loopUpdate(delta);
}

pub fn draw() void {
    for (items) |item| {
        const image: ?zhu.graphics.Image = switch (item.type) {
            .gem => gemAnimation.currentImage(),
            else => null,
        };

        if (image) |img| {
            batch.drawImage(img, item.position, .{});
        }
    }
}
```

## 效果

![实现钻石动画][1]

[1]: images/阳光岛12.gif

## 附录
