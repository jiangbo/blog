# 1129-阳光岛-实现青蛙行为

## 目标

实现青蛙的跳跃行为。

## 环境

- Time 2026-01-29
- Zig 0.15.1

## 参考

1. <https://www.bilibili.com/video/BV1jf9XYQEhW>

## 想法

参考了负鼠和老鹰的实现，青蛙的行为是跳跃，然后落地，重复这个过程。

## object.zig

实现了青蛙的跳跃，其它不相关的代码没有列出来。

```zig
const gravity = 980; // 重力
var jumpTimer: zhu.Timer = .init(2.5);
var jumpRight: bool = true;
fn updateFrog(object: *map.Object, delta: f32) void {
    if (jumpTimer.isFinishedLoopUpdate(delta)) {
        const max = object.initPosition.x - 10;
        if (object.position.x > max) jumpRight = false;
        if (object.position.x < max - 90) jumpRight = true;

        const x: f32 = if (jumpRight) 1 else -1;
        object.velocity = .xy(50 * x, -350);
    }

    const pos = object.position.add(object.object.?.position);
    object.velocity.y = object.velocity.y + gravity * delta;
    const toPosition = pos.add(object.velocity.scale(delta));

    const size = object.object.?.size;
    const clamped = map.clamp(pos, toPosition, size);
    if (clamped.y == pos.y) object.velocity = .zero;

    object.position = clamped.sub(object.object.?.position);

    frogState = if (object.velocity.y == 0) .idle //
        else if (object.velocity.y < 0) .jump else .fall;
}
```

## 效果

![实现青蛙行为][1]

[1]: images/阳光岛27.gif

## 附录
