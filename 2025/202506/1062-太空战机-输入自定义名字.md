# 1062-太空战机-输入自定义名字

## 目标

结束后，玩家可以输入自己的名字，然后显示到结束场景的底部。

## 环境

- Time 2025-12-09
- Zig 0.15.1

## 参考

1. <https://www.bilibili.com/video/BV1wSCFYQEyc>

## 想法

输入文字的时候，目前处理不了输入法的问题，这个问题先记下来，后面有时间再解决。
背景动画一直动，导致录制 gif 很大，所以就先关闭背景的渲染，完成再打开。

## end.zig

```zig
const std = @import("std");
const zhu = @import("zhu");

const camera = zhu.camera;
const text = zhu.text;

const player = @import("player.zig");

var isTyping: bool = true;
var nameUnicode: [20]u21 = undefined;
var nameIndex: u8 = 0;
var nameBuffer: [nameUnicode.len * 3]u8 = undefined;
var name: []u8 = &.{};

pub fn handleEvent(event: *const zhu.window.Event) void {
    if (!isTyping or event.type != .CHAR) return;

    nameUnicode[nameIndex] = @intCast(event.char_code);
    nameIndex += 1;
    name = text.encodeUtf8(&nameBuffer, nameUnicode[0..nameIndex]);
}

pub fn update(delta: f32) void {
    _ = delta;
}

pub fn draw() void {
    var buffer: [255]u8 = undefined;
    const score = zhu.format(&buffer, "你的得分是：{}", .{player.score});
    text.drawCenter(score, 0.1, .{ .spacing = 2 });

    text.drawCenter("GAME OVER", 0.35, .{ .size = 72, .spacing = 5 });

    const typing = "请输入你的名字，按回车键确认：";
    text.drawCenter(typing, 0.6, .{ .spacing = 2 });

    if (nameIndex > 0) {
        text.drawCenter(name, 0.8, .{ .spacing = 2 });
    }
}
```

## 效果

![输入自定义名字][1]

[1]: images/太空战机22.gif

## 附录
