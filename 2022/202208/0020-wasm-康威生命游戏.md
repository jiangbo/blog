# 0020-wasm-康威生命游戏

## 环境

- Time 2022-05-17
- Rust 1.60.0
- Node 12.22.5
- wasm-pack 0.10.2

## 前言

### 说明

参考：<https://rustwasm.github.io/docs/book/game-of-life/interactivity.html>

### 目标

在上一节的基础上进行。给游戏增加暂停和继续功能。

## index.html

```html
<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="utf-8">
  <title>康威生命游戏</title>
  <style>
    body {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
  </style>
</head>


<body>
  <button id="play-pause"></button>
  <hr>
  <canvas id="game"></canvas>
  <script src="./bootstrap.js"></script>
</body>

</html>
```

## animationId

```js
const universe = Universe.new(WIDTH, HEIGHT);
let animationId = null;
const renderLoop = () => {
    drawGrid();
    drawCells();
    universe.tick();
    animationId = requestAnimationFrame(renderLoop);
};
```

## 增加点击事件

```js
const playPauseButton = document.getElementById("play-pause");
const play = () => {
    playPauseButton.textContent = "暂停";
    renderLoop();
};

const pause = () => {
    playPauseButton.textContent = "继续";
    cancelAnimationFrame(animationId);
    animationId = null;
};

playPauseButton.addEventListener("click", _ => {
    animationId === null ? play() : pause();
});

play()
```

### 效果

![暂停和继续][1]

## 总结

实现了游戏的暂停和继续功能。

[1]: images/pause-continue.gif

## 附录
